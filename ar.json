{
  "copilot_action_name": "LINUX-BLOCK-UNBLOCK-IP-COPILOT-ACTION",
  "description": "Blocks or unblocks a specified IPv4 address using iptables. Validates IP format, supports both blocking and unblocking modes, logs actions, and outputs NDJSON including the target IP, action taken, and resulting status. Writes atomically to the Active Response log with .new fallback if locked.",
  "technology": "Linux",
  "icon": "linux",
  "script_parameters": [
    {
      "name": "TARGET_IP",
      "type": "string",
      "required": true,
      "description": "IPv4 address to block or unblock (e.g., 203.0.113.45).",
      "default": null,
      "arg_position" : "1"
    },
    {
      "name": "ACTION",
      "type": "string",
      "required": false,
      "description": "Operation mode: 'block' (default) or 'unblock'.",
      "default": "block",
      "enum": ["block", "unblock"],
      "arg_position" : "2"
    },
    {
      "name": "ARLog",
      "type": "string",
      "required": false,
      "description": "Active Response NDJSON output path. JSON entries are appended to this file.",
      "default": "/var/ossec/active-response/active-responses.log"
    },
    {
      "name": "LogPath",
      "type": "string",
      "required": false,
      "description": "Path to the rotating human-readable script log.",
      "default": "/tmp/LinuxFirewall-script.log"
    }
  ],
  "repo_url": "https://raw.githubusercontent.com/socfortress/LINUX-BLOCK-UNBLOCK-IP-COPILOT-ACTION/refs/heads/main/",
  "script_name": "block-unblock-ip.sh",
  "version": "1.0.0",
  "last_updated": "2025-08-23T00:00:00Z"
}
